(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{212:function(e,n,t){e.exports=t.p+"assets/img/v2-a98ec85570158e7eb8601534984bb22c_1440w.a98ec855.jpg"},213:function(e,n,t){e.exports=t.p+"assets/img/1492200-20181023200852131-291342969.e681c247.png"},261:function(e,n,t){"use strict";t.r(n);var r=t(5),a=Object(r.a)({},(function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"响应式-observe-过程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#响应式-observe-过程"}},[e._v("#")]),e._v(" 响应式 observe 过程")]),e._v(" "),r("h2",{attrs:{id:"发布订阅模式-vs-观察者模式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#发布订阅模式-vs-观察者模式"}},[e._v("#")]),e._v(" 发布订阅模式 VS 观察者模式")]),e._v(" "),r("p",[e._v("个人理解：")]),e._v(" "),r("ul",[r("li",[e._v("观察者模式是是观察对象和目标直接进行交互。（数据源直接通知订阅者发生改变。）")]),e._v(" "),r("li",[e._v("发布订阅模式是在观察者模式上做的优化，目标和订阅者中间存在一个调度的中间层，由中间层统一控制。（数据源告诉第三方（事件频道）发生了改变，第三方再通知订阅者发生了改变。）\n"),r("img",{attrs:{src:t(212),alt:"v2-a98ec85570158e7eb8601534984bb22c_1440w.jpg"}}),e._v(" "),r("img",{attrs:{src:t(213),alt:"1492200-20181023200852131-291342969.png"}})])]),e._v(" "),r("h2",{attrs:{id:"对象侦测"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#对象侦测"}},[e._v("#")]),e._v(" 对象侦测")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("    function observer(target){\n        if(typeof target !== 'object' || target === null){\n            return;\n        }\n        for(key in target){\n            defineReactive(target,key,target[key])\n            console.log(key)\n        }\n    }\n    function defineReactive (target,key,val){\n        //递归调用\n        observer(target[key])\n        Object.defineProperty(target,key,{\n            get() {\n                console.log('get');\n                return value;\n            },\n            set:function (newValue) {\n                console.log('set');\n                if(newValue !== value){\n                    target[key] = newValue;\n                }\n            }\n        })\n    }\n    let json = {\n        name:'kira',\n        age:30,\n        address:{\n            text1:{\n                des1:1,\n                des2:3\n            },\n            text2:2\n        }\n    }\n    console.log('json.name',json.name)\n    observer(json)\n")])])]),r("h2",{attrs:{id:"数组侦测"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#数组侦测"}},[e._v("#")]),e._v(" 数组侦测")]),e._v(" "),r("p",[e._v("思路：由于 Object.defindProperty()不具备侦测数组的能力，vue 通过对原生数据方法进行替换，当劫持到 key 是数组类型，通过自定义的数组操作方法覆盖该 key 原型上数组的操作方法。")]),e._v(" "),r("p",[e._v("自定义数组操作方法的实现思路，更新视图，并原生数组操作方法。")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("//重新定义数组原型\nconst oldArrayProperty = Array.prototype;\n//创建新对象 原型指向oldArrayProperty 扩展的新方法不会影响原型\nconst arrProto = Object.create(oldArrayProperty);\n// pop push shift unshift splice\n['pop','push','shift','unshift','splice'].forEach(name=>{\n    arrProto[name] = function () {\n        //更新视图\n        updateView();\n        //调用原生数组更新方法\n        oldArrayProperty[name].call(this,...arguments)\n    }\n});\n\nfunction observer(target){\n    if(typeof target !== 'object' || target === null){\n        return;\n    }\n\n    if(Array.isArray(target)){\n        target .__proto__ =  arrProto\n    }\n    for(key in target){\n        defineReactive(target,key,target[key])\n        console.log(key)\n    }\n}\n\nfunction updateView() {\n    console.log('更新视图')\n}\nfunction defineReactive (target,key,val){\n    //递归调用\n    observer(target[key]);\n    Object.defineProperty(target,key,{\n        get() {\n            console.log('get');\n            return val;\n        },\n        set:function (newValue) {\n            console.log('set');\n            if(newValue !== val){\n                target[key] = newValue;\n            }\n        }\n    })\n}\nlet json = {\n    name:'kira',\n    age:30,\n    address:{\n        text1:{\n            des1:1,\n            des2:3\n        },\n        text2:2\n    }\n};\nconsole.log('json.name',json.name);\nobserver(json);\n\n")])])])])}),[],!1,null,null,null);n.default=a.exports}}]);